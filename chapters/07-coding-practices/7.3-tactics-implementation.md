# **7.3 Tactics & Implementation**

Once the architecture is chosen, use these coding tactics to keep the codebase clean and AI-friendly.

### **7.3.1 Implementation Best Practices**

#### **1\. Refactor Driver Methods (Orchestrators)**

* **Problem:** Driver methods (controllers/handlers) often become "God functions" with 50+ lines of imperative logic.  
* **Solution:** Extract every logical step into a private helper function.  
* **Benefit:** The main function becomes a readable "table of contents" for the operation.

**Before (Hard to read/test):**

async function handler(req) {  
  // validate, map, db transaction, audit, cache, notify...  
  // 50 lines of mixed logic  
}

**After (Readable Orchestration):**

async function createUser(dto: UserInput) {  
  const payload \= this.validateAndMap(dto);  
  return this.withTransaction(async () \=\> {  
     const user \= await this.persistUser(payload);  
     await Promise.all(\[  
         this.audit(user),  
         this.notify(user)  
     \]);  
     return user;  
  });  
}

#### **2\. Preserve Shared Schemas**

Keep a single source of truth (Zod/OpenAPI) for DTOs.

#### **3\. Use Repositories**

Encapsulate persistence. If you switch from SQL to NoSQL, your business logic shouldn't break.

#### **4\. Centralize Validation**

Don't validate data in the UI *and* the Controller *and* the Service *and* the DB. Validate at the entry gate (Controller/Service boundary).

### **7.3.2 AI Integration: Prompting & Guardrails**

To get the best out of GitHub Copilot or other AI tools, provide context on your architectural patterns.

**Prompting Strategy:**

* **Contextualize:** "I am using the Repository pattern with Zod schemas."  
* **Scaffold Tests:** "Create a UserRepository... include Jest unit tests for the error cases."  
* **Review:** "Generate a method to update users. Ensure it respects the userUpdateSchema."

**Guardrails:**

* **Never** accept generated SQL queries without reviewing for Injection risks.  
* **Always** verify that AI-generated code handles edge cases (nulls, empty arrays, timeout errors).